<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=0" />
    <meta name="format-detection" content="telephone=yes,email=no" />
    <meta name="x5-orientation" content="portrait" />
    <meta name="x5-fullscreen" content="true" />
    <meta name="x5-page-mode" content="app" />
    <title>享优惠</title>
    <script>
        if (window.screen.availWidth <= 750) {
            document.documentElement.style.fontSize = (100 / 750 * window.screen.availWidth) + 'px';
        } else {
            document.documentElement.style.fontSize = '100px';
        }
    </script>
    <link rel="stylesheet" type="text/css" href="../../css/base.min.css?v=2.0.3" />
    <link rel="stylesheet" type="text/css" href="../../lib/layer.mobile-v2.0/layer_mobile/need/layer.min.css"/>
    <link rel="stylesheet" href="../../css/login.min.css?v=2.0.0">
    <link rel="stylesheet" href="vant.css">
    <link rel="stylesheet" href="model.css">
    <style>
        .d{
            display: block;
            width: 6.9rem;
            height: 4rem;   
            margin: .2rem auto 0;
            box-shadow: 0 0px 10px #ddd;
            background: none;
            border-radius: .2rem;
            clear: both;
            overflow: hidden;
        }
        .d img{
            display:block;
            width: 100%;
            height: 100%;
            float: left;
        };  
        body #app .van-popup {
            background: none!important;
        }
        body #app .txfs {
        width: 6rem;
        height: 6rem;
        background: none;
        margin: 0 auto;
        position: relative;
        }
        body #app .txfs .img_b {
        width: 5.83rem;
        height: 4.73rem;
        margin: 0 auto;
        background: url('img/img_youka.png');
        background-size: 100% 100%;
        }
        body #app .txfs .four {
        width: 4.86rem;
        height: .68rem;
        background: #fff;
        margin: 0 auto;
        position: absolute;
        left: 50%;
        margin-left: -2.43rem;
        border-radius: .1rem;
        }
        body #app .txfs .four span {
        display: inline-block;
        font-size: .3rem;
        font-family: PingFangSC-Regular;
        font-weight: 400;
        line-height: .68rem;
        padding-left: .2rem;
        }
        body #app .txfs .four span:nth-child(2) {
        color: #F14836;
        }
        body #app .txfs .four2 {
        bottom: 1.7rem;
        }
        body #app .txfs .four1 {
        bottom: 2.7rem;
        }
        body #app .txfs .close_i {
        width: .75rem;
        height: .75rem;
        background: none;
        background: url('img/csp.png');
        background-size: 13.46rem 10.67rem;
        background-position: -10.5rem -6.35rem;
        margin: .5rem auto 0;
        }
        .redShare{position: fixed;right:0;top:1rem;}
    </style>
</head>

<body>
    <div id="app">
        <div class="d d1" @click="f1()">
                <img src="img/img_jishigou_1.png?v=2.0.0" alt="">
        </div>

        <div class="d d2" @click="f2()">
                <img src="img/img_jishigou_2.png?v=2.0.0" alt="">
        </div>


        <div class="d d3" @click="f3()">
                <img src="img/img_jishigou_3.png?v=2.0.0" alt="">
        </div>


        <van-popup v-model="show" close-on-click-overlay='false' style="background: none!important;">
            <div class="txfs">
                <div class="img_b">

                </div>
                <div class="four four1">
                    <span>1. 购买请加微信号:</span>
                    <span>JeremyLi120</span>
                </div>
                <div class="four four2">
                        <span>2. 联系电话:</span>
                        <span>15691959091</span>
                </div>

                <div class="close_i" @click=close_()></div>
            </div>

        </van-popup>
    </div>
<!-- 分享指引 -->
<img src="../../images/red.png" alt="" class="redShare">
<!-- 弹层 -->
<div class="ui-dialog ui-dialog-operate show-dialog">
    <div class="ui-dialog-cnt">
        <div class="ui-dialog-bd">
            <div class="looks"></div>
            <p>* 好友注册保宝车服后，您还可获得额外奖励；注册的好友越多，获得奖励越多！快邀请好友注册赚钱吧！</p>
            <a href="#" class="notice">活动规则&gt;&gt;</a>
        </div>
        <i class="ui-dialog-close" data-role="button"></i>
    </div>
</div>
</body>
<script src="https://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
<script src="js/jquery-3.3.1.min.js"></script>
<script src="js/vue.min.js"></script>
<script src="js/vant.min.js"></script>
<script src="../../lib/fastclick 1.0.6/fastclick.min.js"></script>
<script src="../../lib/layer.mobile-v2.0/layer_mobile/layer.min.js"></script>
<script>
    document.write("<script src='../../js/config.js?v=" + Math.random() + "' charset='utf-8'><\/script>");
    document.close();
</script>
<script src="../../js/login.js?v=2.0.4"></script>
<script>
    var vm = new Vue({
        el:'#app',
        data:{
            show:false
        },
        methods:{
            init(){
                var that = this;
                document.write("<div style='display:none;'><script src='https://s13.cnzz.com/z_stat.php?id=1274913797&web_id=1274913797' language='JavaScript'><\/script><\/div>");
                app.verificationUserInfo();
            },
            f1(){
                var that = this;
                document.write("<script src='https://s19.cnzz.com/z_stat.php?id=1274913764&web_id=1274913764' language='JavaScript'><\/script>");
                window.location.href = "https://c.360doo.com/d.aspx?c=4091&p=23610&v=57B3E44B3E3ACA34"
            },
            f2(){
                var that = this;
                document.write("<script src='https://s22.cnzz.com/z_stat.php?id=1274913728&web_id=1274913728' language='JavaScript'><\/script>");
                window.location.href = "https://wxcs.nuoweibd.com/statics/wxcs.nuoweibd.com/h5/Views/Haif/Haif.html?userType=2&source=501"
            },
            f3(){
                var that = this;
                document.write("<div style='display:none;'><script src='https://s19.cnzz.com/z_stat.php?id=1274913805&web_id=1274913805' language='JavaScript'><\/script><\/div>");
                that.show = true;
            },
            close_(){
                var that = this;
                that.show = false;
            }
        },
        mounted(){
            var that = this;
            that.init();
        }
    });  
</script>
<script>
    $(function(){
        if (api.isDebug) {
            } else {
                $.ajax({
                    url: api.NWBDApiGetWxTicket + "?r=" + Math.random(),
                    type: "POST",
                    async: false,
                    data: {
                        wxUrl: window.location.href,
                        openid: app.getItem("open_id")
                    },
                    success: function (result) {
                        if (result.status === "success" && result.code === 0) {
                            wx.config({
                                debug: api.isDebug,
                                appId: result.data.AppID,
                                timestamp: result.data.timestamp,
                                nonceStr: result.data.noncestr,
                                signature: result.data.signature,
                                jsApiList: [
                                    'hideOptionMenu',       //  隐藏分享菜单
                                    'checkJsApi',           //
                                    'onMenuShareTimeline',  //  分享到朋友圈
                                    'onMenuShareAppMessage',    //  分享给朋友
                                    'chooseWXPay',
                                    'hideAllNonBaseMenuItem',
                                    'openLocation']
                            });
                            wx.ready(function () {
                                //新增分享
                                wx.checkJsApi({
                                    jsApiList: ['chooseImage'], //  需要检测的JS接口列表
                                    success: function (res) {
                                        console.log(res)
                                    }
                                });

                                var i = window.location.href.indexOf('?');
                                var e = window.location.href.indexOf('&');
                                var id = app.getItem('userInfo').id;
                                var shareUrl = api.shareAdd + id;
                                var obj = {
                                    //  朋友圈
                                    title: api.shareText,   //  标题
                                    desc: api.shareText2,   //  描述
                                    link: shareUrl, //  分享链接
                                    imgUrl: api.imgUrl, //  分享图标
                                    success: function () {
                                        layer.close();

                                        $.ajax({
                                            url: api.NWBDApiWeiXinShareHaif,
                                            type: 'POST',       
                                            data: {
                                               uniqueCode: app.getItem('userInfo').id,
                                               source: 'CUSTOMER',
                                               status:'SUCCEED'
                                            },
                                        })
                                        .done(function(res) {
                                            console.log(res);
                                            var list=res;
                                            console.log(list.status)
                                            if(list.status=="success"){
                                                $.ajax({
                                                    url: api.NWBDApiWeiXinShareModel,
                                                    type: 'POST',
                                                    data: {
                                                        commissionType:'QR_CODE_SHARE',
                                                        openid:app.getItem("open_id")
                                                    },
                                                })
                                                .done(function(req) {
                                                    $('.ui-dialog').addClass('show')
                                                    if($('.show-dialog .ui-dialog-bd>h1').length==0){
                                                        var item = req
                                                        var items='<h1>'+item.data+'<span>'+'元'+'</span>'+'</h1>';
                                                        $('.ui-dialog-bd').prepend(items);
                                                    } 
                                                    $('.ui-dialog-close').click(function (event) {
                                                    $(this).parents('.ui-dialog').removeClass('show');
                                                })
                                            });
                                        } 
                                    })
                                },
                            };
                                if (!app.getItem('userInfo').id) {
                                    wx.hideAllNonBaseMenuItem();    //  隐藏所有非基础按钮
                                } else {
                                    wx.onMenuShareTimeline(obj) //  分享到朋友圈
                                    wx.onMenuShareAppMessage(obj)   //  分享给朋友
                                }
                            });
                            wx.error(function (res) {
                                console.log(res)
                                alert("公众号页面授权失败");
                                app.f_close();
                            });
                        } else {
                            alert("获取授权失败");
                            app.f_close();
                        }
                    },
                    error: function () {
                        alert("网络异常，请检查网络");
                        app.f_close();
                    }
                });
        }
    })
</script>
</html>